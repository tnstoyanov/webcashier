@{
    ViewData["Title"] = "Nuvei Success";
}
<div class="container py-5">
    <h1 class="h3">Payment Successful</h1>
    <p>Your Google Pay Nuvei transaction completed successfully.</p>
    <hr />
    <h2 class="h5 mt-4">Highlighted Fields</h2>
    <div class="table-responsive mb-4">
        <table class="table table-sm table-bordered align-middle">
            <thead class="table-light"><tr><th>Parameter</th><th>Value</th></tr></thead>
            <tbody>
@{
    // Prefer totalAmount; if absent fall back to total_amount. Avoid duplication.
    var raw = Context.Request.Query;
    var primary = new List<string> { "Status","merchant_unique_id","customData","totalAmount","total_amount","currency","TransactionID","cardBrand","issuerName" };
    var seenLogical = new HashSet<string>(StringComparer.OrdinalIgnoreCase);
    foreach (var k in primary)
    {
        if ((k == "total_amount" || k == "totalAmount") && seenLogical.Contains("totalAmount")) continue;
        var v = raw[k].ToString();
        if (!string.IsNullOrEmpty(v)) {
            if (k == "total_amount" || k == "totalAmount") seenLogical.Add("totalAmount");
            <tr><td>@k</td><td>@v</td></tr>;
        }
    }
}
            </tbody>
        </table>
    </div>
    <h2 class="h5">All Callback Parameters</h2>
    <div class="table-responsive">
        <table class="table table-sm table-bordered align-middle">
            <thead class="table-light"><tr><th>Parameter</th><th>Value</th></tr></thead>
            <tbody>
@{
    var allKeys = raw.Keys.OrderBy(k => k, StringComparer.OrdinalIgnoreCase).ToList();
    foreach (var k in allKeys)
    {
        var v = raw[k].ToString();
        if (!string.IsNullOrEmpty(v))
        {
            <tr><td>@k</td><td>@v</td></tr>;
        }
    }
}
            </tbody>
        </table>
    </div>
    <a href="/Payment?paymentMethod=gpay" class="btn btn-primary mt-3">Back to GPay Nuvei</a>
</div>
